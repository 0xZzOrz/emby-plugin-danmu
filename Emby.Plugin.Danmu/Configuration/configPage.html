<div id="TemplateConfigPage" data-role="page" class="page type-interior pluginConfigurationPage"
    data-require="emby-input,emby-button,emby-select,emby-checkbox" data-controller="__plugin/danmuJs">
    <div data-role="content">
        <div class="content-primary">
            <div class="verticalSection verticalSection">
                <div class="sectionTitleContainer flex align-items-center">
                    <h2 class="sectionTitle">Danmu 配置</h2>
                    <span id="current_version" name="current_version" is="emby-linkbutton" class="emby-button"></span>
                    <a is="emby-linkbutton" class="raised button-alt headerHelpButton emby-button" target="_blank"
                        href="https://github.com/0xZzOrz/emby-plugin-danmu">源码</a>
                    <a is="emby-linkbutton" class="raised button-alt headerHelpButton emby-button" target="_blank"
                        href="https://github.com/cxfksword/jellyfin-plugin-danmu">感谢cxfksword原版源码</a>
                </div>
            </div>

            <form id="TemplateConfigForm">
                <fieldset class="verticalSection verticalSection-extrabottompadding">
                    <legend>
                        <h3>弹幕下载配置</h3>
                    </legend>
                    <div class="checkboxContainer checkboxContainer-withDescription">
                        <label class="emby-checkbox-label">
                            <input id="EnableAutoDownload" name="EnableAutoDownload" type="checkbox" is="emby-checkbox" />
                            <span>弹幕自动匹配下载</span>
                        </label>
                        <div class="fieldDescription">勾选后，有新影片入库会自动匹配下载，不勾选需要自己搜索下载。</div>
                    </div>
                    <div class="checkboxContainer checkboxContainer-withDescription">
                        <label class="emby-checkbox-label">
                            <input id="EnableEpisodeCountSame" name="EnableEpisodeCountSame" type="checkbox" is="emby-checkbox" />
                            <span>弹幕总数需和电视剧总集数一致</span>
                        </label>
                        <div class="fieldDescription">勾选后，假如匹配了错误的电视剧，可以避免自动下载错误的弹幕。</div>
                    </div>
                </fieldset>

                <fieldset class="verticalSection verticalSection-extrabottompadding">
                    <legend>
                        <h3>弹幕源配置</h3>
                    </legend>
                    <div class="itemsContainer vertical-list" is="emby-itemscontainer" id="Scrapers" name="Scrapers">
                    </div>
                </fieldset>

                <fieldset id="dandanSection" class="verticalSection verticalSection-extrabottompadding" style="display: none;">
                    <legend>
                        <h3>弹弹play配置</h3>
                    </legend>
                    <div class="checkboxContainer checkboxContainer-withDescription">
                        <label class="emby-checkbox-label">
                            <input id="WithRelatedDanmu" name="WithRelatedDanmu" type="checkbox" is="emby-checkbox" />
                            <span>同时获取关联的第三方弹幕</span>
                        </label>
                        <div class="fieldDescription">勾选后，返回此弹幕库对应的所有第三方关联网址的弹幕.</div>
                    </div>
                    <div class="inputContainer">
                        <label class="inputLabel inputLabelUnfocused" for="ChConvert">弹幕中文简繁转换</label>
                        <select is="emby-select" id="ChConvert" name="ChConvert" class="emby-select-withcolor emby-select">
                            <option value="0">不转换</option>
                            <option value="1">转换为简体</option>
                            <option value="2">转换为繁体</option>
                        </select>
                    </div>
                    <div class="checkboxContainer checkboxContainer-withDescription">
                        <label class="emby-checkbox-label">
                            <input id="MatchByFileHash" name="MatchByFileHash" type="checkbox" is="emby-checkbox" />
                            <span>使用文件哈希值进行匹配</span>
                        </label>
                        <div class="fieldDescription">勾选后，搜索和匹配的成功率和精确度会更高，但会消耗额外的计算资源，当视频文件存储在远端时还会占用网络带宽。</div>
                    </div>
                </fieldset>

                <fieldset id="danmuApiSection" class="verticalSection verticalSection-extrabottompadding">
                    <legend>
                        <h3>弹幕API配置</h3>
                    </legend>
                    <div class="fieldDescription" style="color: #ff9800; margin-bottom: 1em;">
                        ⚠️ 弹幕下载速度受API服务器限流配置影响
                    </div>
                    <div class="inputContainer">
                        <label class="inputLabel inputLabelUnfocused" for="DanmuApiServerUrl">API服务器地址</label>
                        <input id="DanmuApiServerUrl" name="DanmuApiServerUrl" type="text" is="emby-input" placeholder="http://example.com/{token}" />
                        <div class="fieldDescription">填写API服务器的完整地址（包含 http:// 或 https://），部署推荐: <a href="https://github.com/huangxd-/danmu_api" target="_blank">danmu_api</a></div>
                    </div>
                    <div class="inputContainer">
                        <label class="inputLabel inputLabelUnfocused" for="DanmuApiAllowedSources">允许的采集源</label>
                        <input id="DanmuApiAllowedSources" name="DanmuApiAllowedSources" type="text" is="emby-input" placeholder="如：renren,hanjutv,bahamut" />
                        <div class="fieldDescription">限制只从指定采集源获取弹幕，多个采集源用逗号分隔，留空则不限制采集源。</div>
                    </div>
                </fieldset>

                <fieldset class="verticalSection verticalSection-extrabottompadding">
                    <legend>
                        <h3>生成ASS配置</h3>
                    </legend>
                    <div class="checkboxContainer checkboxContainer-withDescription">
                        <label class="emby-checkbox-label">
                            <input id="ToAss" name="ToAss" type="checkbox" is="emby-checkbox" />
                            <span>同时生成ASS格式弹幕</span>
                        </label>
                        <div class="fieldDescription">勾选后，会在视频目录下生成ass格式的弹幕，命名格式：[视频名].danmu.ass</div>
                    </div>
                    <div class="inputContainer ass">
                        <label class="inputLabel inputLabelUnfocused" for="AssFont">ass弹幕字体</label>
                        <input id="AssFont" name="AssFont" type="text" is="emby-input" />
                        <div class="fieldDescription">可为空，默认黑体.</div>
                    </div>
                    <div class="inputContainer ass">
                        <label class="inputLabel inputLabelUnfocused" for="AssFontSize">ass弹幕字体大小</label>
                        <input id="AssFontSize" name="AssFontSize" type="number" is="emby-input" min="25" />
                        <div class="fieldDescription">可为空，默认60，可以此为基准，增大或缩小.</div>
                    </div>
                    <div class="inputContainer ass">
                        <label class="inputLabel inputLabelUnfocused" for="AssTextOpacity">ass弹幕字体透明度</label>
                        <input id="AssTextOpacity" name="AssTextOpacity" type="text" is="emby-input" />
                        <div class="fieldDescription">可为空，默认1，表示不透明，数值在0.0~1.0之间</div>
                    </div>
                    <div class="inputContainer ass">
                        <label class="inputLabel inputLabelUnfocused" for="AssLineCount">ass弹幕显示行数</label>
                        <input id="AssLineCount" name="AssLineCount" type="number" is="emby-input" min="0" />
                        <div class="fieldDescription">可为空，默认全屏显示，1/4屏可填5，半屏可填9</div>
                    </div>
                    <div class="inputContainer ass">
                        <label class="inputLabel inputLabelUnfocused" for="AssSpeed">ass弹幕移动速度</label>
                        <input id="AssSpeed" name="AssSpeed" type="number" is="emby-input" min="0" />
                        <div class="fieldDescription">可为空，默认8秒</div>
                    </div>
                </fieldset>

                <div>
                    <button is="emby-button" type="submit" class="raised button-submit block emby-button">
                        <span>Save</span>
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

